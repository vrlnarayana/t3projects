INFO:     Started server process [7068]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://34.168.108.74:8501

INFO:     Started server process [7789]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://34.168.108.74:8501

INFO:     127.0.0.1:56198 - "GET /leads?skip=0&limit=100 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: leads.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 428, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/fastapi/applications.py", line 276, in __call__
    await super().__call__(scope, receive, send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/fastapi/concurrency.py", line 36, in contextmanager_in_threadpool
    raise e
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: leads.id
[SQL: SELECT leads.id AS leads_id, leads.name AS leads_name, leads.company AS leads_company, leads.email AS leads_email, leads.status AS leads_status 
FROM leads
 LIMIT ? OFFSET ?]
[parameters: (100, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:     127.0.0.1:45912 - "GET /leads?skip=0&limit=100 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: leads.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 428, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/fastapi/applications.py", line 276, in __call__
    await super().__call__(scope, receive, send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/fastapi/concurrency.py", line 36, in contextmanager_in_threadpool
    raise e
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: leads.id
[SQL: SELECT leads.id AS leads_id, leads.name AS leads_name, leads.company AS leads_company, leads.email AS leads_email, leads.status AS leads_status 
FROM leads
 LIMIT ? OFFSET ?]
[parameters: (100, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:     Started server process [2408]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://34.82.131.247:8501

INFO:     127.0.0.1:58478 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:36568 - "POST /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:36570 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:36570 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:59624 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:59624 - "GET /leads HTTP/1.1" 200 OK
2023-05-11 09:33:21.176 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 77, in frontend_app
    value=result["name"],
          ~~~~~~^^^^^^^^
TypeError: list indices must be integers or slices, not str
INFO:     127.0.0.1:45782 - "DELETE /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:45782 - "DELETE /leads HTTP/1.1" 405 Method Not Allowed
INFO:     127.0.0.1:45784 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
2023-05-11 09:33:40.930 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 186, in frontend_app
    if response.ok:
       ^^^^^^^^
UnboundLocalError: cannot access local variable 'response' where it is not associated with a value
2023-05-11 09:34:00.337 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 186, in frontend_app
    if response.ok:
       ^^^^^^^^
UnboundLocalError: cannot access local variable 'response' where it is not associated with a value
2023-05-11 09:34:03.172 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/openai/openai_object.py", line 59, in __getattr__
    return self[k]
           ~~~~^^^
KeyError: 'ok'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 186, in frontend_app
    if response.ok:
       ^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/openai/openai_object.py", line 61, in __getattr__
    raise AttributeError(*err.args)
AttributeError: ok
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/3.11.1/bin/uvicorn", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 410, in main
    run(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 578, in run
    server.run()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/config.py", line 473, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/importer.py", line 24, in import_from_string
    raise exc from None
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1206, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1178, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1149, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/workspace/t3projects/t3projects/service/service.py", line 15, in <module>
    from models import Leads
ModuleNotFoundError: No module named 'models'

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://34.82.244.255:8501

2023-05-16 05:40:22.653 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 41, in frontend_app
    st.set_page_config(page_title="FastAPI Chatbot")
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/metrics_util.py", line 311, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/commands/page_config.py", line 225, in set_page_config
    ctx.enqueue(msg)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_run_context.py", line 90, in enqueue
    raise StreamlitAPIException(
streamlit.errors.StreamlitAPIException: `set_page_config()` can only be called once per app, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/library/api-reference/utilities/st.set_page_config).
2023-05-16 05:41:39.292 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f9fb438b390>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fb438b390>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fb438b390>: Failed to establish a new connection: [Errno 111] Connection refused'))
2023-05-16 05:44:23.222 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f9fb7ea0b10>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fb7ea0b10>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fb7ea0b10>: Failed to establish a new connection: [Errno 111] Connection refused'))
2023-05-16 05:45:17.094 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f9fc5d632d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fc5d632d0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 565, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9fc5d632d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
INFO:     Started server process [4597]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://34.82.244.255:8501

INFO:     127.0.0.1:38712 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38120 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:34924 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:34924 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:43958 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:45206 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41896 - "GET /leads?skip=1&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41904 - "GET /leads?skip=2&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41910 - "GET /leads?skip=3&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41918 - "GET /leads?skip=4&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54012 - "GET /leads?skip=5&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54014 - "GET /leads?skip=5&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38646 - "GET /leads?skip=5&limit=4 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38662 - "GET /leads?skip=0&limit=4 HTTP/1.1" 200 OK
INFO:     127.0.0.1:34110 - "GET /leads?skip=0&limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:34126 - "GET /leads?skip=1&limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:45840 - "GET /leads?skip=2&limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41022 - "GET /leads?skip=1&limit=2 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54858 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:54858 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:58512 - "GET /leads/Creative%20Business%20Systems HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58528 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:58528 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:33760 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:55766 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:43366 - "GET /search_leads?search_type=name&search_query=Creative+Business+Systems HTTP/1.1" 200 OK
INFO:     127.0.0.1:43380 - "GET /search_leads?search_type=name&search_query=Creative+Business HTTP/1.1" 200 OK
INFO:     127.0.0.1:58422 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:45012 - "GET /search_leads?search_type=company&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:45020 - "GET /search_leads?search_type=company&search_query=Creative+Business+Systems HTTP/1.1" 200 OK
INFO:     127.0.0.1:37808 - "GET /search_leads?search_type=company&search_query= HTTP/1.1" 200 OK
INFO:     127.0.0.1:39236 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:39236 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:45918 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60634 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:60634 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:41060 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49510 - "GET /leads?skip=5&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:49518 - "GET /leads?skip=5&limit=5 HTTP/1.1" 200 OK
INFO:     127.0.0.1:42078 - "GET /leads?skip=5&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51480 - "GET /leads?skip=10&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:51484 - "GET /leads?skip=8&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:47168 - "GET /leads?skip=1&limit=10 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55432 - "GET /leads?skip=0&limit=10 HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/3.11.1/bin/uvicorn", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 410, in main
    run(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 578, in run
    server.run()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/config.py", line 473, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1206, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1178, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1149, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/workspace/t3projects/service/service.py", line 25, in <module>
    OPENAI_API_KEY = os.environ["OPENAI_API_KEY"]
                     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "<frozen os>", line 679, in __getitem__
KeyError: 'OPENAI_API_KEY'

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.185.213.135:8501

2023-06-07 12:54:20.828 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 13, in <module>
    OPENAI_API_KEY = os.environ['OPENAI_API_KEY']
                     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "<frozen os>", line 679, in __getitem__
KeyError: 'OPENAI_API_KEY'
2023-06-07 12:56:39.316 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 6, in <module>
    import utility.pdf2html as pdf2html
  File "/workspace/t3projects/utility/pdf2html.py", line 4, in <module>
    from streamlit_javascript import st_javascript
ModuleNotFoundError: No module named 'streamlit_javascript'
2023-06-07 12:57:20.292 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 10, in app
    yourname, yourpass, allowentry = login.login()
                                     ^^^^^^^^^^^^^
  File "/workspace/t3projects/auth/login.py", line 11, in login
    authallow=au.authenticate(yourname, yourpass)  # authenticate with name,passcode not empty and passcode matching
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/auth/authenticate.py", line 23, in authenticate
    ret = readdata(yourname)
          ^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/auth/authenticate.py", line 8, in readdata
    con = sqlite_conn()
          ^^^^^^^^^^^^^
  File "/workspace/t3projects/auth/authenticate.py", line 4, in sqlite_conn
    con = sqlite3.connect('db/turiyatree.db')
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file
2023-06-07 13:00:45.272 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f25b27a4ad0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f25b27a4ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f25b27a4ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/3.11.1/bin/uvicorn", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 410, in main
    run(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 578, in run
    server.run()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/config.py", line 473, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1206, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1178, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1149, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/workspace/t3projects/service/service.py", line 25, in <module>
    OPENAI_API_KEY = os.environ["OPENAI_API_KEY"]
                     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "<frozen os>", line 679, in __getitem__
KeyError: 'OPENAI_API_KEY'

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.185.213.135:8501

2023-06-07 13:02:25.819 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fbe2821a550>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbe2821a550>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbe2821a550>: Failed to establish a new connection: [Errno 111] Connection refused'))
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/3.11.1/bin/uvicorn", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 410, in main
    run(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/main.py", line 578, in run
    server.run()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/server.py", line 68, in serve
    config.load()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/config.py", line 473, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/uvicorn/importer.py", line 21, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1206, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1178, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1149, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/workspace/t3projects/service/service.py", line 25, in <module>
    OPENAI_API_KEY = os.environ["OPENAI_API_KEY"]
                     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "<frozen os>", line 679, in __getitem__
KeyError: 'OPENAI_API_KEY'
2023-06-07 13:03:13.019 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fbe2816e0d0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbe2816e0d0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 163, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads?skip=0&limit=100 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbe2816e0d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
INFO:     Started server process [2072]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.185.213.135:8501

2023-06-07 13:20:56.687 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number ' (type=value_error)
INFO:     Started server process [2549]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.185.213.135:8501

2023-06-07 13:22:00.755 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number ' (type=value_error)
2023-06-07 13:22:44.558 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 19, in app
    cb.main()
  File "/workspace/t3projects/crawl/chatbot.py", line 37, in main
    conn = duckdb.connect(database='duckdb/turiyatree.db')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.IOException: IO Error: Cannot open file "/workspace/t3projects/duckdb/turiyatree.db": No such file or directory
INFO:     127.0.0.1:48028 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-07 13:26:19.764 Uncaught app exception
Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fb50478ea90>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 487, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/gitpod/.pyenv/versions/3.11.1/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb50478ea90>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 185, in frontend_app
    response = requests.get(
               ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/requests/adapters.py", line 520, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /leads/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb50478ea90>: Failed to establish a new connection: [Errno 111] Connection refused'))
INFO:     Started server process [2878]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.185.213.135:8501

INFO:     127.0.0.1:38112 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:38112 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:42440 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     Started server process [1267]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.233.241.3:8501

2023-06-09 07:37:39.306 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number ' (type=value_error)
2023-06-09 07:43:59.265 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-09 07:46:34.948 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-09 07:49:06.752 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number ' (type=value_error)
2023-06-09 07:49:24.712 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-09 08:15:31.094 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-09 09:03:47.573 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
  Stopping...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1267]
INFO:     Started server process [1136]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.247.98.186:8501

2023-06-13 11:33:28.799 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-13 11:33:57.301 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. ' order_number' (type=value_error)
2023-06-13 11:34:14.057 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-13 11:44:49.806 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. ' \n            request_type' (type=value_error)
2023-06-13 11:45:04.136 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'request_type' (type=value_error)
2023-06-13 11:45:51.665 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'endpoint_url' (type=value_error)
INFO:     127.0.0.1:47194 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-13 11:47:15.373 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^
NameError: name 'get_query_plan' is not defined
2023-06-13 11:49:21.954 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(self,st.session_state["messages"])
                                       ^^^^
NameError: name 'self' is not defined
2023-06-13 11:49:35.755 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: LLMAgent.get_query_plan() missing 1 required positional argument: 'query'
2023-06-13 11:50:44.376 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan('',st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 38, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: 'str' object has no attribute 'llm'
2023-06-13 11:51:28.660 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan('',st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 38, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: 'str' object has no attribute 'llm'
2023-06-13 11:51:41.744 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan('',st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 38, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: 'str' object has no attribute 'llm'
2023-06-13 11:54:46.869 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(self=self,st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 38, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: 'str' object has no attribute 'llm'
2023-06-13 11:56:21.042 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 143
    response = LLMAgent.get_query_plan(self=self,st.session_state["messages"])
                                                                             ^
SyntaxError: positional argument follows keyword argument
INFO:     127.0.0.1:38972 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-13 11:57:56.145 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(self, st.session_state["messages"])
                                       ^^^^
NameError: name 'self' is not defined
2023-06-13 11:58:23.936 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: LLMAgent.get_query_plan() missing 1 required positional argument: 'query'
2023-06-13 12:00:19.848 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = LLMAgent.get_query_plan(LLMAgent,st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 41, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: type object 'LLMAgent' has no attribute 'llm'
INFO:     127.0.0.1:50056 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
2023-06-13 13:04:01.729 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = agent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 41, in get_query_plan
    chain = LLMChain(llm=self.llm, prompt=self.prompt)
                         ^^^^^^^^
AttributeError: type object 'LLMAgent' has no attribute 'llm'
2023-06-13 13:06:25.525 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = agent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 41, in get_query_plan
    chain = LLMChain(llm=self.llms, prompt=self.prompt)
                         ^^^^^^^^^
AttributeError: 'LLMAgent' object has no attribute 'llms'
2023-06-13 13:12:48.418 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
INFO:     127.0.0.1:48692 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:44072 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59242 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-13 13:51:40.034 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 19, in app
    cb.main()
  File "/workspace/t3projects/crawl/chatbot.py", line 37, in main
    conn = duckdb.connect(database='duckdb/turiyatree.db')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.IOException: IO Error: Cannot open file "/workspace/t3projects/duckdb/turiyatree.db": No such file or directory
2023-06-13 13:51:43.662 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 19, in app
    cb.main()
  File "/workspace/t3projects/crawl/chatbot.py", line 113, in main
    crawl.crawl(openai.api_key)
  File "/workspace/t3projects/crawl/crawl.py", line 15, in crawl
    con = duckdb.connect(database='duckdb/turiyatree.db')
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.IOException: IO Error: Cannot open file "/workspace/t3projects/duckdb/turiyatree.db": No such file or directory
INFO:     127.0.0.1:42946 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     Started server process [1318]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)

Collecting usage statistics. To deactivate, set browser.gatherUsageStats to False.


  You can now view your Streamlit app in your browser.

  Network URL: http://10.0.5.2:8501
  External URL: http://35.197.108.21:8501

INFO:     127.0.0.1:55694 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:42130 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-14 08:04:56.877 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-14 08:05:11.613 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
2023-06-14 08:05:48.759 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 2, in <module>
    from research import app
  File "/workspace/t3projects/research.py", line 2, in <module>
    import sales.salesquery as sq
  File "/workspace/t3projects/sales/salesquery.py", line 14, in <module>
    import sales.frontend as fend
  File "/workspace/t3projects/sales/frontend.py", line 6, in <module>
    from sales.llm_agent import LLMAgent
  File "/workspace/t3projects/sales/llm_agent.py", line 10, in <module>
    prompt = PromptTemplate(
             ^^^^^^^^^^^^^^^
  File "pydantic/main.py", line 341, in pydantic.main.BaseModel.__init__
pydantic.error_wrappers.ValidationError: 1 validation error for PromptTemplate
__root__
  Invalid prompt schema; check for mismatched or missing input parameters. 'order_number' (type=value_error)
INFO:     127.0.0.1:45392 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
2023-06-14 08:10:19.434 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = agent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 45, in get_query_plan
    for item in response["choices"]:
                ~~~~~~~~^^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
2023-06-14 08:12:09.659 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = agent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 46, in get_query_plan
    for item in response["choices"]:
                ~~~~~~~~^^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
2023-06-14 08:13:09.268 Uncaught app exception
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 552, in _run_script
    exec(code, module.__dict__)
  File "/workspace/t3projects/app.py", line 8, in <module>
    run()
  File "/workspace/t3projects/app.py", line 5, in run
    app()
  File "/workspace/t3projects/research.py", line 16, in app
    sq.main()
  File "/workspace/t3projects/sales/salesquery.py", line 67, in main
    fend.frontend_app()
  File "/workspace/t3projects/sales/frontend.py", line 143, in frontend_app
    response = agent.get_query_plan(st.session_state["messages"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/t3projects/sales/llm_agent.py", line 46, in get_query_plan
    for item in response["choices"]:
                ~~~~~~~~^^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
INFO:     127.0.0.1:36832 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:34350 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56696 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55750 - "GET /leads/ HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:55750 - "GET /leads HTTP/1.1" 200 OK
INFO:     127.0.0.1:55758 - "GET /search_leads?search_type=name&search_query= HTTP/1.1" 200 OK
INFO:     192.168.36.201:36836 - "GET / HTTP/1.1" 404 Not Found
INFO:     192.168.36.201:36848 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     192.168.36.201:60822 - "GET / HTTP/1.1" 404 Not Found
INFO:     192.168.36.201:60888 - "GET / HTTP/1.1" 404 Not Found
INFO:     192.168.36.201:45778 - "GET /docs HTTP/1.1" 200 OK
INFO:     192.168.36.201:45794 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.36.201:59222 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     192.168.36.201:43642 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:59664 - "GET /leads?skip=0&limit=100 HTTP/1.1" 200 OK
